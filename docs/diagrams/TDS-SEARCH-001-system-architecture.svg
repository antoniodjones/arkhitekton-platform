<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#2d3748"/>
    </marker>
    <marker id="arrow-blue" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#4299e1"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="40" font-family="Arial" font-size="24" font-weight="bold" fill="#1a202c" text-anchor="middle">Global Search &amp; Discovery - System Architecture</text>
  <text x="600" y="65" font-family="Arial" font-size="14" fill="#4a5568" text-anchor="middle">TDS-SEARCH-001 | High-Level Component View</text>

  <!-- CLIENT LAYER -->
  <rect x="50" y="100" width="1100" height="200" fill="#edf2f7" stroke="#4299e1" stroke-width="2" rx="8"/>
  <text x="75" y="130" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748">CLIENT LAYER (React)</text>
  
  <!-- Dashboard -->
  <rect x="80" y="150" width="200" height="120" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="180" y="175" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">Dashboard</text>
  <text x="180" y="195" font-family="Arial" font-size="11" fill="#4a5568" text-anchor="middle">dashboard.tsx</text>
  <text x="95" y="220" font-family="Arial" font-size="11" fill="#4a5568">• Search Input</text>
  <text x="95" y="240" font-family="Arial" font-size="11" fill="#4a5568">• Results Dropdown</text>
  <text x="95" y="260" font-family="Arial" font-size="11" fill="#4a5568">• Keyboard Handler</text>

  <!-- Hooks -->
  <rect x="320" y="150" width="200" height="120" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="420" y="175" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">Custom Hooks</text>
  <text x="335" y="200" font-family="Arial" font-size="11" fill="#4a5568">• useGlobalSearch()</text>
  <text x="335" y="220" font-family="Arial" font-size="11" fill="#4a5568">• useDebouncedSearch()</text>
  <text x="335" y="240" font-family="Arial" font-size="11" fill="#4a5568">• useSearchShortcut()</text>
  <text x="335" y="260" font-family="Arial" font-size="11" fill="#4a5568">• React Query</text>

  <!-- Components -->
  <rect x="560" y="150" width="200" height="120" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="660" y="175" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">UI Components</text>
  <text x="575" y="200" font-family="Arial" font-size="11" fill="#4a5568">• SearchResultCard</text>
  <text x="575" y="220" font-family="Arial" font-size="11" fill="#4a5568">• SearchResultSkeleton</text>
  <text x="575" y="240" font-family="Arial" font-size="11" fill="#4a5568">• Entity Icons</text>
  <text x="575" y="260" font-family="Arial" font-size="11" fill="#4a5568">• Status Badges</text>

  <!-- Utilities -->
  <rect x="800" y="150" width="200" height="120" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="900" y="175" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">Utilities</text>
  <text x="815" y="200" font-family="Arial" font-size="11" fill="#4a5568">• getEntityTypeInfo()</text>
  <text x="815" y="220" font-family="Arial" font-size="11" fill="#4a5568">• getStatusColor()</text>
  <text x="815" y="240" font-family="Arial" font-size="11" fill="#4a5568">• Type Mapping</text>

  <!-- Libraries -->
  <rect x="1040" y="150" width="100" height="120" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="1090" y="175" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Libraries</text>
  <text x="1055" y="200" font-family="Arial" font-size="10" fill="#4a5568">React Query</text>
  <text x="1055" y="220" font-family="Arial" font-size="10" fill="#4a5568">Wouter</text>
  <text x="1055" y="240" font-family="Arial" font-size="10" fill="#4a5568">hotkeys-hook</text>
  <text x="1055" y="260" font-family="Arial" font-size="10" fill="#4a5568">Shadcn UI</text>

  <!-- SERVER LAYER -->
  <rect x="50" y="340" width="1100" height="180" fill="#f0fff4" stroke="#48bb78" stroke-width="2" rx="8"/>
  <text x="75" y="370" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748">SERVER LAYER (Express.js)</text>

  <!-- API Endpoint -->
  <rect x="80" y="390" width="250" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="205" y="415" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">API Endpoint</text>
  <text x="95" y="440" font-family="Arial" font-size="11" fill="#4a5568">GET /api/entities/search</text>
  <text x="95" y="460" font-family="Arial" font-size="11" fill="#4a5568">Params: q, type, limit</text>
  <text x="95" y="480" font-family="Arial" font-size="11" fill="#4a5568">Response: SearchResponse</text>

  <!-- Search Logic -->
  <rect x="370" y="390" width="250" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="495" y="415" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">Search Logic</text>
  <text x="385" y="440" font-family="Arial" font-size="11" fill="#4a5568">• Query Parsing</text>
  <text x="385" y="460" font-family="Arial" font-size="11" fill="#4a5568">• Relevance Scoring</text>
  <text x="385" y="480" font-family="Arial" font-size="11" fill="#4a5568">• Result Aggregation</text>

  <!-- Storage Interface -->
  <rect x="660" y="390" width="250" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="785" y="415" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748" text-anchor="middle">Storage Interface</text>
  <text x="675" y="440" font-family="Arial" font-size="11" fill="#4a5568">• getAllUserStories()</text>
  <text x="675" y="460" font-family="Arial" font-size="11" fill="#4a5568">• getAllEpics()</text>
  <text x="675" y="480" font-family="Arial" font-size="11" fill="#4a5568">• getAllApplications()</text>

  <!-- DATABASE LAYER -->
  <rect x="50" y="560" width="700" height="180" fill="#fef5e7" stroke="#f6ad55" stroke-width="2" rx="8"/>
  <text x="75" y="590" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748">DATABASE LAYER (PostgreSQL)</text>

  <!-- Core Tables -->
  <rect x="80" y="610" width="150" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="155" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Core Tables</text>
  <text x="95" y="655" font-family="Arial" font-size="10" fill="#4a5568">user_stories</text>
  <text x="95" y="673" font-family="Arial" font-size="10" fill="#4a5568">epics</text>
  <text x="95" y="691" font-family="Arial" font-size="10" fill="#4a5568">defects</text>

  <!-- Portfolio -->
  <rect x="260" y="610" width="150" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="335" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Portfolio</text>
  <text x="275" y="655" font-family="Arial" font-size="10" fill="#4a5568">applications</text>
  <text x="275" y="673" font-family="Arial" font-size="10" fill="#4a5568">initiatives</text>

  <!-- Knowledge -->
  <rect x="440" y="610" width="150" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="515" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Knowledge</text>
  <text x="455" y="655" font-family="Arial" font-size="10" fill="#4a5568">wiki_pages</text>
  <text x="455" y="673" font-family="Arial" font-size="10" fill="#4a5568">models</text>

  <!-- Indexes -->
  <rect x="620" y="610" width="110" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="675" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Indexes</text>
  <text x="635" y="655" font-family="Arial" font-size="10" fill="#4a5568">FTS (GIN)</text>
  <text x="635" y="673" font-family="Arial" font-size="10" fill="#4a5568">Trigram</text>
  <text x="635" y="691" font-family="Arial" font-size="10" fill="#4a5568">B-Tree</text>

  <!-- CACHE LAYER -->
  <rect x="800" y="560" width="350" height="180" fill="#fff5f5" stroke="#fc8181" stroke-width="2" rx="8"/>
  <text x="825" y="590" font-family="Arial" font-size="14" font-weight="bold" fill="#2d3748">CACHING LAYER</text>

  <!-- Client Cache -->
  <rect x="830" y="610" width="140" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="900" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Client Cache</text>
  <text x="900" y="655" font-family="Arial" font-size="11" fill="#4a5568" text-anchor="middle">React Query</text>
  <text x="845" y="675" font-family="Arial" font-size="10" fill="#4a5568">• 5 min stale</text>
  <text x="845" y="693" font-family="Arial" font-size="10" fill="#4a5568">• 10 min GC</text>

  <!-- Server Cache -->
  <rect x="990" y="610" width="140" height="100" fill="#fff" stroke="#2d3748" stroke-width="2" rx="4"/>
  <text x="1060" y="635" font-family="Arial" font-size="12" font-weight="bold" fill="#2d3748" text-anchor="middle">Redis Cache</text>
  <text x="1060" y="655" font-family="Arial" font-size="11" fill="#4a5568" text-anchor="middle">(future)</text>
  <text x="1005" y="675" font-family="Arial" font-size="10" fill="#4a5568">• 5 min TTL</text>
  <text x="1005" y="693" font-family="Arial" font-size="10" fill="#4a5568">• Query cache</text>

  <!-- Arrows -->
  <path d="M 280 210 L 320 210" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 520 210 L 560 210" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 420 270 L 420 340 L 205 340 L 205 390" stroke="#4299e1" stroke-width="2" fill="none" marker-end="url(#arrow-blue)" stroke-dasharray="5,5"/>
  <text x="430" y="320" font-family="Arial" font-size="11" fill="#4299e1">fetch()</text>
  <path d="M 330 440 L 370 440" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 620 440 L 660 440" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 785 490 L 785 530 L 400 530 L 400 610" stroke="#4299e1" stroke-width="2" fill="none" marker-end="url(#arrow-blue)" stroke-dasharray="5,5"/>
  <text x="405" y="565" font-family="Arial" font-size="11" fill="#4299e1">SQL</text>
  <path d="M 205 390 L 205 340 L 180 340 L 180 270" stroke="#4299e1" stroke-width="2" fill="none" marker-end="url(#arrow-blue)" stroke-dasharray="5,5"/>
  <text x="190" y="330" font-family="Arial" font-size="11" fill="#4299e1">JSON</text>
  <path d="M 520 210 L 540 210 L 540 340 L 900 340 L 900 610" stroke="#4299e1" stroke-width="2" fill="none" marker-end="url(#arrow-blue)" stroke-dasharray="5,5"/>
  <text x="670" y="335" font-family="Arial" font-size="11" fill="#4299e1">Cache</text>

  <!-- Legend -->
  <rect x="50" y="760" width="15" height="15" fill="#edf2f7" stroke="#4299e1" stroke-width="2"/>
  <text x="75" y="772" font-family="Arial" font-size="11" fill="#4a5568">Client</text>
  <rect x="150" y="760" width="15" height="15" fill="#f0fff4" stroke="#48bb78" stroke-width="2"/>
  <text x="175" y="772" font-family="Arial" font-size="11" fill="#4a5568">Server</text>
  <rect x="250" y="760" width="15" height="15" fill="#fef5e7" stroke="#f6ad55" stroke-width="2"/>
  <text x="275" y="772" font-family="Arial" font-size="11" fill="#4a5568">Database</text>
  <rect x="370" y="760" width="15" height="15" fill="#fff5f5" stroke="#fc8181" stroke-width="2"/>
  <text x="395" y="772" font-family="Arial" font-size="11" fill="#4a5568">Cache</text>
  <line x1="500" y1="767" x2="540" y2="767" stroke="#2d3748" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="550" y="772" font-family="Arial" font-size="11" fill="#4a5568">Sync</text>
  <line x1="620" y1="767" x2="660" y2="767" stroke="#4299e1" stroke-width="2" marker-end="url(#arrow-blue)" stroke-dasharray="5,5"/>
  <text x="670" y="772" font-family="Arial" font-size="11" fill="#4a5568">Async</text>
</svg>
